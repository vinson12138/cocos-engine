
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'engine-dev/cocos2d/core/renderer/utils/label/letter-font.js';
                    var __require = nodeEnv ? function (request) {
                        return require(request);
                    } : function (request) {
                        return __quick_compile_engine__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_engine__.registerModule(__filename, module);}"use strict";

exports.__esModule = true;
exports["default"] = void 0;

var _bmfont = _interopRequireDefault(require("../../webgl/assemblers/label/2d/bmfont"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var Label = require('../../../components/CCLabel');

var LabelOutline = require('../../../components/CCLabelOutline');

var textUtils = require('../../../utils/text-utils');

var Component = require('../../../components/CCComponent');

var RenderTexture = require('../../../assets/CCRenderTexture');

var OUTLINE_SUPPORTED = cc.js.isChildClassOf(LabelOutline, Component);

var getFontFamily = require('../utils').getFontFamily;

var shareLabelInfo = require('../utils').shareLabelInfo;

var FontLetterDefinition = cc.BitmapFont.FontLetterDefinition;
var FontAtlas = cc.BitmapFont.FontAtlas;
var WHITE = cc.Color.WHITE;
var space = 0;
var bleed = 2;

var _invisibleAlpha = (1 / 255).toFixed(3);

function LetterTexture(_char, labelInfo) {
  this._texture = null;
  this._labelInfo = labelInfo;
  this._char = _char;
  this._hash = null;
  this._data = null;
  this._canvas = null;
  this._context = null;
  this._width = 0;
  this._height = 0;
  this._offsetY = 0;
  this._hash = _char.charCodeAt(0) + labelInfo.hash;
}

LetterTexture.prototype = {
  constructor: LetterTexture,
  updateRenderData: function updateRenderData() {
    this._updateProperties();

    this._updateTexture();
  },
  _updateProperties: function _updateProperties() {
    this._texture = new cc.Texture2D();
    this._data = Label._canvasPool.get();
    this._canvas = this._data.canvas;
    this._context = this._data.context;
    this._context.font = this._labelInfo.fontDesc;
    var width = textUtils.safeMeasureText(this._context, this._char, this._labelInfo.fontDesc);
    var blank = this._labelInfo.margin * 2 + bleed;
    this._width = parseFloat(width.toFixed(2)) + blank;
    this._height = (1 + textUtils.BASELINE_RATIO) * this._labelInfo.fontSize + blank;
    this._offsetY = -(this._labelInfo.fontSize * textUtils.BASELINE_RATIO) / 2;

    if (this._canvas.width !== this._width) {
      this._canvas.width = this._width;
    }

    if (this._canvas.height !== this._height) {
      this._canvas.height = this._height;
    }

    this._texture.initWithElement(this._canvas);
  },
  _updateTexture: function _updateTexture() {
    var context = this._context;
    var labelInfo = this._labelInfo,
        width = this._canvas.width,
        height = this._canvas.height;
    var fontSize = this._labelInfo.fontSize;
    var startX = width / 2;
    var startY = height / 2 + fontSize * textUtils.MIDDLE_RATIO + fontSize * textUtils.BASELINE_OFFSET;
    var color = labelInfo.color; // use round for line join to avoid sharp intersect point

    context.lineJoin = 'round';
    context.textAlign = 'center';
    context.clearRect(0, 0, width, height); //Add a white background to avoid black edges.

    context.fillStyle = "rgba(" + color.r + ", " + color.g + ", " + color.b + ", " + _invisibleAlpha + ")";
    context.fillRect(0, 0, width, height);
    context.font = labelInfo.fontDesc;
    context.fillStyle = "rgba(" + color.r + ", " + color.g + ", " + color.b + ", 1)";

    if (labelInfo.isOutlined && labelInfo.margin > 0) {
      var strokeColor = labelInfo.out || WHITE;
      context.strokeStyle = "rgba(" + strokeColor.r + ", " + strokeColor.g + ", " + strokeColor.b + ", " + strokeColor.a / 255 + ")";
      context.lineWidth = labelInfo.margin * 2;
      context.strokeText(this._char, startX, startY);
    }

    context.fillText(this._char, startX, startY);

    this._texture.handleLoadedTexture();
  },
  destroy: function destroy() {
    this._texture.destroy();

    this._texture = null;

    Label._canvasPool.put(this._data);
  }
};

function LetterAtlas(width, height) {
  var texture = new RenderTexture();
  texture.initWithSize(width, height);
  texture.update();
  this._fontDefDictionary = new FontAtlas(texture);
  this._x = space;
  this._y = space;
  this._nexty = space;
  this._width = width;
  this._height = height;
  cc.director.on(cc.Director.EVENT_BEFORE_SCENE_LAUNCH, this.beforeSceneLoad, this);
}

cc.js.mixin(LetterAtlas.prototype, {
  insertLetterTexture: function insertLetterTexture(letterTexture) {
    var texture = letterTexture._texture;
    var width = texture.width,
        height = texture.height;

    if (this._x + width + space > this._width) {
      this._x = space;
      this._y = this._nexty;
    }

    if (this._y + height > this._nexty) {
      this._nexty = this._y + height + space;
    }

    if (this._nexty > this._height) {
      return null;
    }

    this._fontDefDictionary._texture.drawTextureAt(texture, this._x, this._y);

    this._dirty = true;
    var letter = new FontLetterDefinition();
    letter.u = this._x + bleed / 2;
    letter.v = this._y + bleed / 2;
    letter.texture = this._fontDefDictionary._texture;
    letter.valid = true;
    letter.w = letterTexture._width - bleed;
    letter.h = letterTexture._height - bleed;
    letter.xAdvance = letter.w;
    letter.offsetY = letterTexture._offsetY;
    this._x += width + space;

    this._fontDefDictionary.addLetterDefinitions(letterTexture._hash, letter);

    return letter;
  },
  update: function update() {
    if (!this._dirty) return;

    this._fontDefDictionary._texture.update();

    this._dirty = false;
  },
  reset: function reset() {
    this._x = space;
    this._y = space;
    this._nexty = space;
    var chars = this._fontDefDictionary._letterDefinitions;

    for (var i = 0, l = chars.length; i < l; i++) {
      var _char2 = chars[i];

      if (!_char2.isValid) {
        continue;
      }

      _char2.destroy();
    }

    this._fontDefDictionary.clear();
  },
  destroy: function destroy() {
    this.reset();

    this._fontDefDictionary._texture.destroy();

    this._fontDefDictionary._texture = null;
  },
  beforeSceneLoad: function beforeSceneLoad() {
    this.clearAllCache();
  },
  clearAllCache: function clearAllCache() {
    this.destroy();
    var texture = new RenderTexture();
    texture.initWithSize(this._width, this._height);
    texture.update();
    this._fontDefDictionary._texture = texture;
  },
  getLetter: function getLetter(key) {
    return this._fontDefDictionary._letterDefinitions[key];
  },
  getTexture: function getTexture() {
    return this._fontDefDictionary.getTexture();
  },
  getLetterDefinitionForChar: function getLetterDefinitionForChar(_char3, labelInfo) {
    var hash = _char3.charCodeAt(0) + labelInfo.hash;
    var letter = this._fontDefDictionary._letterDefinitions[hash];

    if (!letter) {
      var temp = new LetterTexture(_char3, labelInfo);
      temp.updateRenderData();
      letter = this.insertLetterTexture(temp);
      temp.destroy();
    }

    return letter;
  }
});

function computeHash(labelInfo) {
  var hashData = '';
  var color = labelInfo.color.toHEX();
  var out = '';

  if (labelInfo.isOutlined && labelInfo.margin > 0) {
    out = out + labelInfo.margin + labelInfo.out.toHEX();
  }

  return hashData + labelInfo.fontSize + labelInfo.fontFamily + color + out;
}

var _shareAtlas = null;
var _atlasWidth = 2048;
var _atlasHeight = 2048;
var _isBold = false;

var LetterFontAssembler = /*#__PURE__*/function (_WebglBmfontAssembler) {
  _inheritsLoose(LetterFontAssembler, _WebglBmfontAssembler);

  function LetterFontAssembler() {
    return _WebglBmfontAssembler.apply(this, arguments) || this;
  }

  var _proto = LetterFontAssembler.prototype;

  _proto._getAssemblerData = function _getAssemblerData() {
    if (!_shareAtlas) {
      _shareAtlas = new LetterAtlas(_atlasWidth, _atlasHeight);
      cc.Label._shareAtlas = _shareAtlas;
    }

    return _shareAtlas.getTexture();
  };

  _proto._updateFontFamily = function _updateFontFamily(comp) {
    shareLabelInfo.fontAtlas = _shareAtlas;
    shareLabelInfo.fontFamily = getFontFamily(comp); // outline

    var outline = OUTLINE_SUPPORTED && comp.getComponent(LabelOutline);

    if (outline && outline.enabled) {
      shareLabelInfo.isOutlined = true;
      shareLabelInfo.margin = outline.width;
      shareLabelInfo.out = outline.color.clone();
      shareLabelInfo.out.a = outline.color.a * comp.node.color.a / 255.0;
    } else {
      shareLabelInfo.isOutlined = false;
      shareLabelInfo.margin = 0;
    }
  };

  _proto._updateLabelInfo = function _updateLabelInfo(comp) {
    shareLabelInfo.fontDesc = this._getFontDesc();
    shareLabelInfo.color = comp.node.color;
    shareLabelInfo.hash = computeHash(shareLabelInfo);
  };

  _proto._getFontDesc = function _getFontDesc() {
    var fontDesc = shareLabelInfo.fontSize.toString() + 'px ';
    fontDesc = fontDesc + shareLabelInfo.fontFamily;

    if (_isBold) {
      fontDesc = "bold " + fontDesc;
    }

    return fontDesc;
  };

  _proto._computeHorizontalKerningForText = function _computeHorizontalKerningForText() {};

  _proto._determineRect = function _determineRect(tempRect) {
    return false;
  };

  return LetterFontAssembler;
}(_bmfont["default"]);

exports["default"] = LetterFontAssembler;
module.exports = exports["default"];
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_engine__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVuZ2luZS1kZXYvY29jb3MyZC9jb3JlL3JlbmRlcmVyL3V0aWxzL2xhYmVsL2xldHRlci1mb250LmpzIl0sIm5hbWVzIjpbIkxhYmVsIiwicmVxdWlyZSIsIkxhYmVsT3V0bGluZSIsInRleHRVdGlscyIsIkNvbXBvbmVudCIsIlJlbmRlclRleHR1cmUiLCJPVVRMSU5FX1NVUFBPUlRFRCIsImNjIiwianMiLCJpc0NoaWxkQ2xhc3NPZiIsImdldEZvbnRGYW1pbHkiLCJzaGFyZUxhYmVsSW5mbyIsIkZvbnRMZXR0ZXJEZWZpbml0aW9uIiwiQml0bWFwRm9udCIsIkZvbnRBdGxhcyIsIldISVRFIiwiQ29sb3IiLCJzcGFjZSIsImJsZWVkIiwiX2ludmlzaWJsZUFscGhhIiwidG9GaXhlZCIsIkxldHRlclRleHR1cmUiLCJjaGFyIiwibGFiZWxJbmZvIiwiX3RleHR1cmUiLCJfbGFiZWxJbmZvIiwiX2NoYXIiLCJfaGFzaCIsIl9kYXRhIiwiX2NhbnZhcyIsIl9jb250ZXh0IiwiX3dpZHRoIiwiX2hlaWdodCIsIl9vZmZzZXRZIiwiY2hhckNvZGVBdCIsImhhc2giLCJwcm90b3R5cGUiLCJjb25zdHJ1Y3RvciIsInVwZGF0ZVJlbmRlckRhdGEiLCJfdXBkYXRlUHJvcGVydGllcyIsIl91cGRhdGVUZXh0dXJlIiwiVGV4dHVyZTJEIiwiX2NhbnZhc1Bvb2wiLCJnZXQiLCJjYW52YXMiLCJjb250ZXh0IiwiZm9udCIsImZvbnREZXNjIiwid2lkdGgiLCJzYWZlTWVhc3VyZVRleHQiLCJibGFuayIsIm1hcmdpbiIsInBhcnNlRmxvYXQiLCJCQVNFTElORV9SQVRJTyIsImZvbnRTaXplIiwiaGVpZ2h0IiwiaW5pdFdpdGhFbGVtZW50Iiwic3RhcnRYIiwic3RhcnRZIiwiTUlERExFX1JBVElPIiwiQkFTRUxJTkVfT0ZGU0VUIiwiY29sb3IiLCJsaW5lSm9pbiIsInRleHRBbGlnbiIsImNsZWFyUmVjdCIsImZpbGxTdHlsZSIsInIiLCJnIiwiYiIsImZpbGxSZWN0IiwiaXNPdXRsaW5lZCIsInN0cm9rZUNvbG9yIiwib3V0Iiwic3Ryb2tlU3R5bGUiLCJhIiwibGluZVdpZHRoIiwic3Ryb2tlVGV4dCIsImZpbGxUZXh0IiwiaGFuZGxlTG9hZGVkVGV4dHVyZSIsImRlc3Ryb3kiLCJwdXQiLCJMZXR0ZXJBdGxhcyIsInRleHR1cmUiLCJpbml0V2l0aFNpemUiLCJ1cGRhdGUiLCJfZm9udERlZkRpY3Rpb25hcnkiLCJfeCIsIl95IiwiX25leHR5IiwiZGlyZWN0b3IiLCJvbiIsIkRpcmVjdG9yIiwiRVZFTlRfQkVGT1JFX1NDRU5FX0xBVU5DSCIsImJlZm9yZVNjZW5lTG9hZCIsIm1peGluIiwiaW5zZXJ0TGV0dGVyVGV4dHVyZSIsImxldHRlclRleHR1cmUiLCJkcmF3VGV4dHVyZUF0IiwiX2RpcnR5IiwibGV0dGVyIiwidSIsInYiLCJ2YWxpZCIsInciLCJoIiwieEFkdmFuY2UiLCJvZmZzZXRZIiwiYWRkTGV0dGVyRGVmaW5pdGlvbnMiLCJyZXNldCIsImNoYXJzIiwiX2xldHRlckRlZmluaXRpb25zIiwiaSIsImwiLCJsZW5ndGgiLCJpc1ZhbGlkIiwiY2xlYXIiLCJjbGVhckFsbENhY2hlIiwiZ2V0TGV0dGVyIiwia2V5IiwiZ2V0VGV4dHVyZSIsImdldExldHRlckRlZmluaXRpb25Gb3JDaGFyIiwidGVtcCIsImNvbXB1dGVIYXNoIiwiaGFzaERhdGEiLCJ0b0hFWCIsImZvbnRGYW1pbHkiLCJfc2hhcmVBdGxhcyIsIl9hdGxhc1dpZHRoIiwiX2F0bGFzSGVpZ2h0IiwiX2lzQm9sZCIsIkxldHRlckZvbnRBc3NlbWJsZXIiLCJfZ2V0QXNzZW1ibGVyRGF0YSIsIl91cGRhdGVGb250RmFtaWx5IiwiY29tcCIsImZvbnRBdGxhcyIsIm91dGxpbmUiLCJnZXRDb21wb25lbnQiLCJlbmFibGVkIiwiY2xvbmUiLCJub2RlIiwiX3VwZGF0ZUxhYmVsSW5mbyIsIl9nZXRGb250RGVzYyIsInRvU3RyaW5nIiwiX2NvbXB1dGVIb3Jpem9udGFsS2VybmluZ0ZvclRleHQi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a0JQLElBQWxCLEVBQXdCO0FBQ3BCMUgsSUFBQUEsY0FBYyxDQUFDb0MsUUFBZixHQUEwQixLQUFLOEYsWUFBTCxFQUExQjtBQUNBbEksSUFBQUEsY0FBYyxDQUFDa0QsS0FBZixHQUF1QndFLElBQUksQ0FBQ00sSUFBTCxDQUFVOUUsS0FBakM7QUFDQWxELElBQUFBLGNBQWMsQ0FBQ3dCLElBQWYsR0FBc0J1RixXQUFXLENBQUMvRyxjQUFELENBQWpDO0FBQ0g7O1NBRURrSSxlQUFBLHdCQUFnQjtBQUNaLFFBQUk5RixRQUFRLEdBQUdwQyxjQUFjLENBQUMyQyxRQUFmLENBQXdCd0YsUUFBeEIsS0FBcUMsS0FBcEQ7QUFDQS9GLElBQUFBLFFBQVEsR0FBR0EsUUFBUSxHQUFHcEMsY0FBYyxDQUFDa0gsVUFBckM7O0FBQ0EsUUFBSUksT0FBSixFQUFhO0FBQ1RsRixNQUFBQSxRQUFRLEdBQUcsVUFBVUEsUUFBckI7QUFDSDs7QUFFRCxXQUFPQSxRQUFQO0FBQ0g7O1NBQ0RnRyxtQ0FBQSw0Q0FBb0MsQ0FBRTs7U0FDdENDLGlCQUFBLHdCQUFnQkMsUUFBaEIsRUFBMEI7QUFDdEIsV0FBTyxLQUFQO0FBQ0g7OztFQTlDNENDIiwic291cmNlc0NvbnRlbnQiOlsiLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiBDb3B5cmlnaHQgKGMpIDIwMTggWGlhbWVuIFlhamkgU29mdHdhcmUgQ28uLCBMdGQuXG5cbiBodHRwczovL3d3dy5jb2Nvcy5jb20vXG5cbiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBlbmdpbmUgc291cmNlIGNvZGUgKHRoZSBcIlNvZnR3YXJlXCIpLCBhIGxpbWl0ZWQsXG4gd29ybGR3aWRlLCByb3lhbHR5LWZyZWUsIG5vbi1hc3NpZ25hYmxlLCByZXZvY2FibGUgYW5kIG5vbi1leGNsdXNpdmUgbGljZW5zZVxuIHRvIHVzZSBDb2NvcyBDcmVhdG9yIHNvbGVseSB0byBkZXZlbG9wIGdhbWVzIG9uIHlvdXIgdGFyZ2V0IHBsYXRmb3Jtcy4gWW91IHNoYWxsXG4gbm90IHVzZSBDb2NvcyBDcmVhdG9yIHNvZnR3YXJlIGZvciBkZXZlbG9waW5nIG90aGVyIHNvZnR3YXJlIG9yIHRvb2xzIHRoYXQnc1xuIHVzZWQgZm9yIGRldmVsb3BpbmcgZ2FtZXMuIFlvdSBhcmUgbm90IGdyYW50ZWQgdG8gcHVibGlzaCwgZGlzdHJpYnV0ZSxcbiBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgQ29jb3MgQ3JlYXRvci5cblxuIFRoZSBzb2Z0d2FyZSBvciB0b29scyBpbiB0aGlzIExpY2Vuc2UgQWdyZWVtZW50IGFyZSBsaWNlbnNlZCwgbm90IHNvbGQuXG4gWGlhbWVuIFlhamkgU29mdHdhcmUgQ28uLCBMdGQuIHJlc2VydmVzIGFsbCByaWdodHMgbm90IGV4cHJlc3NseSBncmFudGVkIHRvIHlvdS5cblxuIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gVEhFIFNPRlRXQVJFLlxuICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbmltcG9ydCBXZWJnbEJtZm9udEFzc2VtYmxlciBmcm9tICcuLi8uLi93ZWJnbC9hc3NlbWJsZXJzL2xhYmVsLzJkL2JtZm9udCc7XG5cbmNvbnN0IExhYmVsID0gcmVxdWlyZSgnLi4vLi4vLi4vY29tcG9uZW50cy9DQ0xhYmVsJyk7XG5jb25zdCBMYWJlbE91dGxpbmUgPSByZXF1aXJlKCcuLi8uLi8uLi9jb21wb25lbnRzL0NDTGFiZWxPdXRsaW5lJyk7XG5jb25zdCB0ZXh0VXRpbHMgPSByZXF1aXJlKCcuLi8uLi8uLi91dGlscy90ZXh0LXV0aWxzJyk7XG5jb25zdCBDb21wb25lbnQgPSByZXF1aXJlKCcuLi8uLi8uLi9jb21wb25lbnRzL0NDQ29tcG9uZW50Jyk7XG5jb25zdCBSZW5kZXJUZXh0dXJlID0gcmVxdWlyZSgnLi4vLi4vLi4vYXNzZXRzL0NDUmVuZGVyVGV4dHVyZScpO1xuY29uc3QgT1VUTElORV9TVVBQT1JURUQgPSBjYy5qcy5pc0NoaWxkQ2xhc3NPZihMYWJlbE91dGxpbmUsIENvbXBvbmVudCk7XG5jb25zdCBnZXRGb250RmFtaWx5ID0gcmVxdWlyZSgnLi4vdXRpbHMnKS5nZXRGb250RmFtaWx5O1xuY29uc3Qgc2hhcmVMYWJlbEluZm8gPSByZXF1aXJlKCcuLi91dGlscycpLnNoYXJlTGFiZWxJbmZvO1xuXG5cbmNvbnN0IEZvbnRMZXR0ZXJEZWZpbml0aW9uID0gY2MuQml0bWFwRm9udC5Gb250TGV0dGVyRGVmaW5pdGlvbjtcbmNvbnN0IEZvbnRBdGxhcyA9IGNjLkJpdG1hcEZvbnQuRm9udEF0bGFzO1xuXG5jb25zdCBXSElURSA9IGNjLkNvbG9yLldISVRFO1xuY29uc3Qgc3BhY2UgPSAwO1xuY29uc3QgYmxlZWQgPSAyO1xuY29uc3QgX2ludmlzaWJsZUFscGhhID0gKDEgLyAyNTUpLnRvRml4ZWQoMyk7XG5cbmZ1bmN0aW9uIExldHRlclRleHR1cmUoY2hhciwgbGFiZWxJbmZvKSB7XG4gICAgdGhpcy5fdGV4dHVyZSA9IG51bGw7XG4gICAgdGhpcy5fbGFiZWxJbmZvID0gbGFiZWxJbmZvO1xuICAgIHRoaXMuX2NoYXIgPSBjaGFyO1xuICAgIHRoaXMuX2hhc2ggPSBudWxsO1xuICAgIHRoaXMuX2RhdGEgPSBudWxsO1xuICAgIHRoaXMuX2NhbnZhcyA9IG51bGw7XG4gICAgdGhpcy5fY29udGV4dCA9IG51bGw7XG4gICAgdGhpcy5fd2lkdGggPSAwO1xuICAgIHRoaXMuX2hlaWdodCA9IDA7XG4gICAgdGhpcy5fb2Zmc2V0WSA9IDA7XG4gICAgdGhpcy5faGFzaCA9IGNoYXIuY2hhckNvZGVBdCgwKSArIGxhYmVsSW5mby5oYXNoO1xufVxuXG5MZXR0ZXJUZXh0dXJlLnByb3RvdHlwZSA9IHtcbiAgICBjb25zdHJ1Y3RvcjogTGV0dGVyVGV4dHVyZSxcblxuICAgIHVwZGF0ZVJlbmRlckRhdGEgKCkge1xuICAgICAgICB0aGlzLl91cGRhdGVQcm9wZXJ0aWVzKCk7XG4gICAgICAgIHRoaXMuX3VwZGF0ZVRleHR1cmUoKTtcbiAgICB9LFxuICAgIF91cGRhdGVQcm9wZXJ0aWVzICgpIHtcbiAgICAgICAgdGhpcy5fdGV4dHVyZSA9IG5ldyBjYy5UZXh0dXJlMkQoKTtcbiAgICAgICAgdGhpcy5fZGF0YSA9IExhYmVsLl9jYW52YXNQb29sLmdldCgpO1xuICAgICAgICB0aGlzLl9jYW52YXMgPSB0aGlzLl9kYXRhLmNhbnZhcztcbiAgICAgICAgdGhpcy5fY29udGV4dCA9IHRoaXMuX2RhdGEuY29udGV4dDtcbiAgICAgICAgdGhpcy5fY29udGV4dC5mb250ID0gdGhpcy5fbGFiZWxJbmZvLmZvbnREZXNjO1xuICAgICAgICBsZXQgd2lkdGggPSB0ZXh0VXRpbHMuc2FmZU1lYXN1cmVUZXh0KHRoaXMuX2NvbnRleHQsIHRoaXMuX2NoYXIsIHRoaXMuX2xhYmVsSW5mby5mb250RGVzYyk7XG4gICAgICAgIGxldCBibGFuayA9IHRoaXMuX2xhYmVsSW5mby5tYXJnaW4gKiAyICsgYmxlZWQ7XG4gICAgICAgIHRoaXMuX3dpZHRoID0gcGFyc2VGbG9hdCh3aWR0aC50b0ZpeGVkKDIpKSArIGJsYW5rO1xuICAgICAgICB0aGlzLl9oZWlnaHQgPSAoMSArIHRleHRVdGlscy5CQVNFTElORV9SQVRJTykgKiB0aGlzLl9sYWJlbEluZm8uZm9udFNpemUgKyBibGFuaztcbiAgICAgICAgdGhpcy5fb2Zmc2V0WSA9IC0gKHRoaXMuX2xhYmVsSW5mby5mb250U2l6ZSAqIHRleHRVdGlscy5CQVNFTElORV9SQVRJTykgLyAyO1xuXG4gICAgICAgIGlmICh0aGlzLl9jYW52YXMud2lkdGggIT09IHRoaXMuX3dpZHRoKSB7XG4gICAgICAgICAgICB0aGlzLl9jYW52YXMud2lkdGggPSB0aGlzLl93aWR0aDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLl9jYW52YXMuaGVpZ2h0ICE9PSB0aGlzLl9oZWlnaHQpIHtcbiAgICAgICAgICAgIHRoaXMuX2NhbnZhcy5oZWlnaHQgPSB0aGlzLl9oZWlnaHQ7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl90ZXh0dXJlLmluaXRXaXRoRWxlbWVudCh0aGlzLl9jYW52YXMpO1xuICAgIH0sXG4gICAgX3VwZGF0ZVRleHR1cmUgKCkge1xuICAgICAgICBsZXQgY29udGV4dCA9IHRoaXMuX2NvbnRleHQ7XG4gICAgICAgIGxldCBsYWJlbEluZm8gPSB0aGlzLl9sYWJlbEluZm8sXG4gICAgICAgICAgICB3aWR0aCA9IHRoaXMuX2NhbnZhcy53aWR0aCxcbiAgICAgICAgICAgIGhlaWdodCA9IHRoaXMuX2NhbnZhcy5oZWlnaHQ7XG5cbiAgICAgICAgY29uc3QgZm9udFNpemUgPSB0aGlzLl9sYWJlbEluZm8uZm9udFNpemU7XG4gICAgICAgIGxldCBzdGFydFggPSB3aWR0aCAvIDI7XG4gICAgICAgIGxldCBzdGFydFkgPSBoZWlnaHQgLyAyICsgIGZvbnRTaXplICogdGV4dFV0aWxzLk1JRERMRV9SQVRJTyArIGZvbnRTaXplICogdGV4dFV0aWxzLkJBU0VMSU5FX09GRlNFVDtcbiAgICAgICAgbGV0IGNvbG9yID0gbGFiZWxJbmZvLmNvbG9yO1xuXG4gICAgICAgIC8vIHVzZSByb3VuZCBmb3IgbGluZSBqb2luIHRvIGF2b2lkIHNoYXJwIGludGVyc2VjdCBwb2ludFxuICAgICAgICBjb250ZXh0LmxpbmVKb2luID0gJ3JvdW5kJztcbiAgICAgICAgY29udGV4dC50ZXh0QWxpZ24gPSAnY2VudGVyJztcbiAgICAgICAgY29udGV4dC5jbGVhclJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCk7XG4gICAgICAgIC8vQWRkIGEgd2hpdGUgYmFja2dyb3VuZCB0byBhdm9pZCBibGFjayBlZGdlcy5cbiAgICAgICAgY29udGV4dC5maWxsU3R5bGUgPSBgcmdiYSgke2NvbG9yLnJ9LCAke2NvbG9yLmd9LCAke2NvbG9yLmJ9LCAke19pbnZpc2libGVBbHBoYX0pYDtcbiAgICAgICAgY29udGV4dC5maWxsUmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgY29udGV4dC5mb250ID0gbGFiZWxJbmZvLmZvbnREZXNjO1xuXG4gICAgICAgIGNvbnRleHQuZmlsbFN0eWxlID0gYHJnYmEoJHtjb2xvci5yfSwgJHtjb2xvci5nfSwgJHtjb2xvci5ifSwgMSlgO1xuICAgICAgICBpZiAobGFiZWxJbmZvLmlzT3V0bGluZWQgJiYgbGFiZWxJbmZvLm1hcmdpbiA+IDApIHtcbiAgICAgICAgICAgIGxldCBzdHJva2VDb2xvciA9IGxhYmVsSW5mby5vdXQgfHwgV0hJVEU7XG4gICAgICAgICAgICBjb250ZXh0LnN0cm9rZVN0eWxlID0gYHJnYmEoJHtzdHJva2VDb2xvci5yfSwgJHtzdHJva2VDb2xvci5nfSwgJHtzdHJva2VDb2xvci5ifSwgJHtzdHJva2VDb2xvci5hIC8gMjU1fSlgO1xuICAgICAgICAgICAgY29udGV4dC5saW5lV2lkdGggPSBsYWJlbEluZm8ubWFyZ2luICogMjtcbiAgICAgICAgICAgIGNvbnRleHQuc3Ryb2tlVGV4dCh0aGlzLl9jaGFyLCBzdGFydFgsIHN0YXJ0WSk7XG4gICAgICAgIH1cbiAgICAgICAgY29udGV4dC5maWxsVGV4dCh0aGlzLl9jaGFyLCBzdGFydFgsIHN0YXJ0WSk7XG5cbiAgICAgICAgdGhpcy5fdGV4dHVyZS5oYW5kbGVMb2FkZWRUZXh0dXJlKCk7XG4gICAgfSxcblxuICAgIGRlc3Ryb3kgKCkge1xuICAgICAgICB0aGlzLl90ZXh0dXJlLmRlc3Ryb3koKTtcbiAgICAgICAgdGhpcy5fdGV4dHVyZSA9IG51bGw7XG4gICAgICAgIExhYmVsLl9jYW52YXNQb29sLnB1dCh0aGlzLl9kYXRhKTtcbiAgICB9LFxufVxuXG5mdW5jdGlvbiBMZXR0ZXJBdGxhcyAod2lkdGgsIGhlaWdodCkge1xuICAgIGxldCB0ZXh0dXJlID0gbmV3IFJlbmRlclRleHR1cmUoKTtcbiAgICB0ZXh0dXJlLmluaXRXaXRoU2l6ZSh3aWR0aCwgaGVpZ2h0KTtcbiAgICB0ZXh0dXJlLnVwZGF0ZSgpO1xuXG4gICAgdGhpcy5fZm9udERlZkRpY3Rpb25hcnkgPSBuZXcgRm9udEF0bGFzKHRleHR1cmUpO1xuICAgIFxuICAgIHRoaXMuX3ggPSBzcGFjZTtcbiAgICB0aGlzLl95ID0gc3BhY2U7XG4gICAgdGhpcy5fbmV4dHkgPSBzcGFjZTtcblxuICAgIHRoaXMuX3dpZHRoID0gd2lkdGg7XG4gICAgdGhpcy5faGVpZ2h0ID0gaGVpZ2h0O1xuXG4gICAgY2MuZGlyZWN0b3Iub24oY2MuRGlyZWN0b3IuRVZFTlRfQkVGT1JFX1NDRU5FX0xBVU5DSCwgdGhpcy5iZWZvcmVTY2VuZUxvYWQsIHRoaXMpO1xufVxuXG5jYy5qcy5taXhpbihMZXR0ZXJBdGxhcy5wcm90b3R5cGUsIHtcbiAgICBpbnNlcnRMZXR0ZXJUZXh0dXJlIChsZXR0ZXJUZXh0dXJlKSB7XG4gICAgICAgIGxldCB0ZXh0dXJlID0gbGV0dGVyVGV4dHVyZS5fdGV4dHVyZTtcbiAgICAgICAgbGV0IHdpZHRoID0gdGV4dHVyZS53aWR0aCwgaGVpZ2h0ID0gdGV4dHVyZS5oZWlnaHQ7ICAgICAgICBcblxuICAgICAgICBpZiAoKHRoaXMuX3ggKyB3aWR0aCArIHNwYWNlKSA+IHRoaXMuX3dpZHRoKSB7XG4gICAgICAgICAgICB0aGlzLl94ID0gc3BhY2U7XG4gICAgICAgICAgICB0aGlzLl95ID0gdGhpcy5fbmV4dHk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoKHRoaXMuX3kgKyBoZWlnaHQpID4gdGhpcy5fbmV4dHkpIHtcbiAgICAgICAgICAgIHRoaXMuX25leHR5ID0gdGhpcy5feSArIGhlaWdodCArIHNwYWNlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuX25leHR5ID4gdGhpcy5faGVpZ2h0KSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2ZvbnREZWZEaWN0aW9uYXJ5Ll90ZXh0dXJlLmRyYXdUZXh0dXJlQXQodGV4dHVyZSwgdGhpcy5feCwgdGhpcy5feSk7XG5cbiAgICAgICAgdGhpcy5fZGlydHkgPSB0cnVlO1xuICAgICAgICBcbiAgICAgICAgbGV0IGxldHRlciA9IG5ldyBGb250TGV0dGVyRGVmaW5pdGlvbigpO1xuICAgICAgICBsZXR0ZXIudSA9IHRoaXMuX3ggKyBibGVlZC8yO1xuICAgICAgICBsZXR0ZXIudiA9IHRoaXMuX3kgKyBibGVlZC8yO1xuICAgICAgICBsZXR0ZXIudGV4dHVyZSA9IHRoaXMuX2ZvbnREZWZEaWN0aW9uYXJ5Ll90ZXh0dXJlO1xuICAgICAgICBsZXR0ZXIudmFsaWQgPSB0cnVlO1xuICAgICAgICBsZXR0ZXIudyA9IGxldHRlclRleHR1cmUuX3dpZHRoIC0gYmxlZWQ7XG4gICAgICAgIGxldHRlci5oID0gbGV0dGVyVGV4dHVyZS5faGVpZ2h0IC0gYmxlZWQ7XG4gICAgICAgIGxldHRlci54QWR2YW5jZSA9IGxldHRlci53O1xuICAgICAgICBsZXR0ZXIub2Zmc2V0WSA9IGxldHRlclRleHR1cmUuX29mZnNldFk7XG5cbiAgICAgICAgdGhpcy5feCArPSB3aWR0aCArIHNwYWNlO1xuXG4gICAgICAgIHRoaXMuX2ZvbnREZWZEaWN0aW9uYXJ5LmFkZExldHRlckRlZmluaXRpb25zKGxldHRlclRleHR1cmUuX2hhc2gsIGxldHRlcik7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gbGV0dGVyXG4gICAgfSxcblxuICAgIHVwZGF0ZSAoKSB7XG4gICAgICAgIGlmICghdGhpcy5fZGlydHkpIHJldHVybjtcbiAgICAgICAgdGhpcy5fZm9udERlZkRpY3Rpb25hcnkuX3RleHR1cmUudXBkYXRlKCk7XG4gICAgICAgIHRoaXMuX2RpcnR5ID0gZmFsc2U7XG4gICAgfSxcblxuICAgIHJlc2V0ICgpIHtcbiAgICAgICAgdGhpcy5feCA9IHNwYWNlO1xuICAgICAgICB0aGlzLl95ID0gc3BhY2U7XG4gICAgICAgIHRoaXMuX25leHR5ID0gc3BhY2U7XG5cbiAgICAgICAgbGV0IGNoYXJzID0gdGhpcy5fZm9udERlZkRpY3Rpb25hcnkuX2xldHRlckRlZmluaXRpb25zO1xuICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IGNoYXJzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgbGV0IGNoYXIgPSBjaGFyc1tpXTtcbiAgICAgICAgICAgIGlmICghY2hhci5pc1ZhbGlkKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjaGFyLmRlc3Ryb3koKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2ZvbnREZWZEaWN0aW9uYXJ5LmNsZWFyKCk7XG4gICAgfSxcblxuICAgIGRlc3Ryb3kgKCkge1xuICAgICAgICB0aGlzLnJlc2V0KCk7XG4gICAgICAgIHRoaXMuX2ZvbnREZWZEaWN0aW9uYXJ5Ll90ZXh0dXJlLmRlc3Ryb3koKTtcbiAgICAgICAgdGhpcy5fZm9udERlZkRpY3Rpb25hcnkuX3RleHR1cmUgPSBudWxsO1xuICAgIH0sXG5cbiAgICBiZWZvcmVTY2VuZUxvYWQgKCkge1xuICAgICAgICB0aGlzLmNsZWFyQWxsQ2FjaGUoKTtcbiAgICB9LFxuXG4gICAgY2xlYXJBbGxDYWNoZSAoKSB7XG4gICAgICAgIHRoaXMuZGVzdHJveSgpO1xuXG4gICAgICAgIGxldCB0ZXh0dXJlID0gbmV3IFJlbmRlclRleHR1cmUoKTtcbiAgICAgICAgdGV4dHVyZS5pbml0V2l0aFNpemUodGhpcy5fd2lkdGgsIHRoaXMuX2hlaWdodCk7XG4gICAgICAgIHRleHR1cmUudXBkYXRlKCk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLl9mb250RGVmRGljdGlvbmFyeS5fdGV4dHVyZSA9IHRleHR1cmU7XG4gICAgfSxcblxuICAgIGdldExldHRlciAoa2V5KSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9mb250RGVmRGljdGlvbmFyeS5fbGV0dGVyRGVmaW5pdGlvbnNba2V5XTtcbiAgICB9LFxuXG4gICAgZ2V0VGV4dHVyZSAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9mb250RGVmRGljdGlvbmFyeS5nZXRUZXh0dXJlKCk7XG4gICAgfSxcblxuICAgIGdldExldHRlckRlZmluaXRpb25Gb3JDaGFyOiBmdW5jdGlvbihjaGFyLCBsYWJlbEluZm8pIHtcbiAgICAgICAgbGV0IGhhc2ggPSBjaGFyLmNoYXJDb2RlQXQoMCkgKyBsYWJlbEluZm8uaGFzaDtcbiAgICAgICAgbGV0IGxldHRlciA9IHRoaXMuX2ZvbnREZWZEaWN0aW9uYXJ5Ll9sZXR0ZXJEZWZpbml0aW9uc1toYXNoXTtcbiAgICAgICAgaWYgKCFsZXR0ZXIpIHtcbiAgICAgICAgICAgIGxldCB0ZW1wID0gbmV3IExldHRlclRleHR1cmUoY2hhciwgbGFiZWxJbmZvKTtcbiAgICAgICAgICAgIHRlbXAudXBkYXRlUmVuZGVyRGF0YSgpO1xuICAgICAgICAgICAgbGV0dGVyID0gdGhpcy5pbnNlcnRMZXR0ZXJUZXh0dXJlKHRlbXApO1xuICAgICAgICAgICAgdGVtcC5kZXN0cm95KCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbGV0dGVyO1xuICAgIH1cbn0pO1xuXG5mdW5jdGlvbiBjb21wdXRlSGFzaCAobGFiZWxJbmZvKSB7XG4gICAgbGV0IGhhc2hEYXRhID0gJyc7XG4gICAgbGV0IGNvbG9yID0gbGFiZWxJbmZvLmNvbG9yLnRvSEVYKCk7XG4gICAgbGV0IG91dCA9ICcnO1xuICAgIGlmIChsYWJlbEluZm8uaXNPdXRsaW5lZCAmJiBsYWJlbEluZm8ubWFyZ2luID4gMCkge1xuICAgICAgICBvdXQgPSBvdXQgKyBsYWJlbEluZm8ubWFyZ2luICsgbGFiZWxJbmZvLm91dC50b0hFWCgpO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gaGFzaERhdGEgKyBsYWJlbEluZm8uZm9udFNpemUgKyBsYWJlbEluZm8uZm9udEZhbWlseSArIGNvbG9yICsgb3V0O1xufVxuXG5sZXQgX3NoYXJlQXRsYXMgPSBudWxsO1xuXG5sZXQgX2F0bGFzV2lkdGggPSAyMDQ4O1xubGV0IF9hdGxhc0hlaWdodCA9IDIwNDg7XG5sZXQgX2lzQm9sZCA9IGZhbHNlO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBMZXR0ZXJGb250QXNzZW1ibGVyIGV4dGVuZHMgV2ViZ2xCbWZvbnRBc3NlbWJsZXIge1xuICAgIF9nZXRBc3NlbWJsZXJEYXRhICgpIHtcbiAgICAgICAgaWYgKCFfc2hhcmVBdGxhcykge1xuICAgICAgICAgICAgX3NoYXJlQXRsYXMgPSBuZXcgTGV0dGVyQXRsYXMoX2F0bGFzV2lkdGgsIF9hdGxhc0hlaWdodCk7XG4gICAgICAgICAgICBjYy5MYWJlbC5fc2hhcmVBdGxhcyA9IF9zaGFyZUF0bGFzO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gX3NoYXJlQXRsYXMuZ2V0VGV4dHVyZSgpO1xuICAgIH1cblxuICAgIF91cGRhdGVGb250RmFtaWx5IChjb21wKSB7XG4gICAgICAgIHNoYXJlTGFiZWxJbmZvLmZvbnRBdGxhcyA9IF9zaGFyZUF0bGFzO1xuICAgICAgICBzaGFyZUxhYmVsSW5mby5mb250RmFtaWx5ID0gZ2V0Rm9udEZhbWlseShjb21wKTtcblxuICAgICAgICAvLyBvdXRsaW5lXG4gICAgICAgIGxldCBvdXRsaW5lID0gT1VUTElORV9TVVBQT1JURUQgJiYgY29tcC5nZXRDb21wb25lbnQoTGFiZWxPdXRsaW5lKTtcbiAgICAgICAgaWYgKG91dGxpbmUgJiYgb3V0bGluZS5lbmFibGVkKSB7XG4gICAgICAgICAgICBzaGFyZUxhYmVsSW5mby5pc091dGxpbmVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHNoYXJlTGFiZWxJbmZvLm1hcmdpbiA9IG91dGxpbmUud2lkdGg7XG4gICAgICAgICAgICBzaGFyZUxhYmVsSW5mby5vdXQgPSBvdXRsaW5lLmNvbG9yLmNsb25lKCk7XG4gICAgICAgICAgICBzaGFyZUxhYmVsSW5mby5vdXQuYSA9IG91dGxpbmUuY29sb3IuYSAqIGNvbXAubm9kZS5jb2xvci5hIC8gMjU1LjA7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBzaGFyZUxhYmVsSW5mby5pc091dGxpbmVkID0gZmFsc2U7XG4gICAgICAgICAgICBzaGFyZUxhYmVsSW5mby5tYXJnaW4gPSAwO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgX3VwZGF0ZUxhYmVsSW5mbyAoY29tcCkge1xuICAgICAgICBzaGFyZUxhYmVsSW5mby5mb250RGVzYyA9IHRoaXMuX2dldEZvbnREZXNjKCk7XG4gICAgICAgIHNoYXJlTGFiZWxJbmZvLmNvbG9yID0gY29tcC5ub2RlLmNvbG9yO1xuICAgICAgICBzaGFyZUxhYmVsSW5mby5oYXNoID0gY29tcHV0ZUhhc2goc2hhcmVMYWJlbEluZm8pO1xuICAgIH1cblxuICAgIF9nZXRGb250RGVzYyAoKSB7XG4gICAgICAgIGxldCBmb250RGVzYyA9IHNoYXJlTGFiZWxJbmZvLmZvbnRTaXplLnRvU3RyaW5nKCkgKyAncHggJztcbiAgICAgICAgZm9udERlc2MgPSBmb250RGVzYyArIHNoYXJlTGFiZWxJbmZvLmZvbnRGYW1pbHk7XG4gICAgICAgIGlmIChfaXNCb2xkKSB7XG4gICAgICAgICAgICBmb250RGVzYyA9IFwiYm9sZCBcIiArIGZvbnREZXNjO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZvbnREZXNjO1xuICAgIH1cbiAgICBfY29tcHV0ZUhvcml6b250YWxLZXJuaW5nRm9yVGV4dCAoKSB7fVxuICAgIF9kZXRlcm1pbmVSZWN0ICh0ZW1wUmVjdCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufSJdLCJzb3VyY2VSb290IjoiLyJ9